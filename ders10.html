<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ders 10: SIMD ve Performans | BERK 101</title>
    <meta name="description" content="BERK'te SIMD, vektÃ¶r iÅŸlemleri ve performans optimizasyonu">
    <meta name="ai-lesson" content="10">
    <meta name="ai-topics" content="SIMD,vector,performance,parallel,AVX,optimization,BerkVect">
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="nav-brand"><a href="index.html" style="text-decoration:none;color:inherit;display:flex;align-items:center;gap:0.5rem;"><span class="logo">ğŸ¦…</span><span class="brand-text">BERK 101</span></a></div>
        <div class="nav-links"><a href="index.html#dersler">TÃ¼m Dersler</a></div>
        <div class="level-switch">
            <button class="level-btn" data-level="ortaokul" title="11-14 yaÅŸ">ğŸ® Ortaokul</button>
            <button class="level-btn active" data-level="lise" title="15-18 yaÅŸ">ğŸ“š Lise</button>
            <button class="level-btn" data-level="universite" title="18+ yaÅŸ">ğŸ“ Ãœniversite</button>
        </div>
        <div class="lang-switch"><button class="lang-btn active" data-lang="tr">TR</button><button class="lang-btn" data-lang="en">EN</button></div>
    </nav>

    <header class="lesson-header">
        <div class="lesson-nav">
            <a href="ders09.html">â† <span class="tr">Ã–nceki</span><span class="en" style="display:none;">Previous</span></a>
            <span class="lesson-meta"><span class="tr">Ders 10 / 10 ğŸ‰</span><span class="en" style="display:none;">Lesson 10 / 10 ğŸ‰</span></span>
        </div>
        <h1 class="lesson-title"><span class="tr">ğŸš€ SIMD ve Performans</span><span class="en" style="display:none;">ğŸš€ SIMD and Performance</span></h1>
        
        <div class="level-info-box" style="margin-top:1rem;">
            <div class="level-info ortaokul-info">
                <span class="level-badge">ğŸ® Ortaokul</span>
                <span class="tr">Bu derste: SÃ¼per gÃ¼Ã§ - Birden fazla iÅŸ aynÄ± anda!</span>
                <span class="en" style="display:none;">In this lesson: Super power - Multiple tasks at once!</span>
            </div>
            <div class="level-info lise-info" style="display:flex;">
                <span class="level-badge">ğŸ“š Lise</span>
                <span class="tr">Bu derste: VektÃ¶r iÅŸlemleri ve paralel hesaplama</span>
                <span class="en" style="display:none;">In this lesson: Vector operations and parallel computing</span>
            </div>
            <div class="level-info universite-info">
                <span class="level-badge">ğŸ“ Ãœniversite</span>
                <span class="tr">Bu derste: SIMD intrinsics, cache optimization ve BerkVect</span>
                <span class="en" style="display:none;">In this lesson: SIMD intrinsics, cache optimization, and BerkVect</span>
            </div>
        </div>
    </header>

    <main class="lesson-content">
        <!-- ==================== ORTAOKUL ==================== -->
        <div class="ortaokul-content">
            <section class="lesson-section">
                <h2>âš¡ <span class="tr">SÃ¼per HÄ±z!</span><span class="en" style="display:none;">Super Speed!</span></h2>
                <p><span class="tr">Normalde iÅŸlemler tek tek yapÄ±lÄ±r. Ama SIMD ile aynÄ± anda 4, 8 hatta 16 iÅŸlem yapabilirsin! ğŸš€</span><span class="en" style="display:none;">Normally operations happen one by one. But with SIMD you can do 4, 8, or even 16 at once! ğŸš€</span></p>
            </section>

            <section class="lesson-section">
                <h2>ğŸ“ <span class="tr">Ã–rnek 1: SÃ¼per Kahraman SaldÄ±rÄ±sÄ±</span><span class="en" style="display:none;">Example 1: Superhero Attack</span></h2>
                <div class="code-block">
                    <div class="code-header"><span class="code-lang">ğŸ¦¸ super_attack.berk</span><button onclick="copyCode(this)">ğŸ“‹ Kopyala</button></div>
                    <pre><code>// Normal saldÄ±rÄ± - tek tek
fonksiyon normal_saldir(dusmanlar: &mut [tamsayÄ±], hasar: tamsayÄ±) {
    yazdir("ğŸ‘Š Normal SaldÄ±rÄ± (tek tek)");
    icin i in 0..dusmanlar.uzunluk() {
        dusmanlar[i] = dusmanlar[i] - hasar;
        yazdir("  DÃ¼ÅŸman {}: {} can kaldÄ±", i, dusmanlar[i]);
    }
}

// SÃœPER SALDIR - hepsine aynÄ± anda!
fonksiyon super_saldir(dusmanlar: &mut [tamsayÄ±], hasar: tamsayÄ±) {
    yazdir("âš¡ SÃœPER SALDIRI (hepsine aynÄ± anda!)");
    // SIMD: 4 dÃ¼ÅŸmana aynÄ± anda vur!
    dusmanlar.simd_cikar(hasar);
    icin (i, can) in dusmanlar.numarala() {
        yazdir("  DÃ¼ÅŸman {}: {} can kaldÄ±", i, can);
    }
}

fonksiyon ana() {
    deÄŸiÅŸken mut dusmanlar1 = [100, 100, 100, 100];
    deÄŸiÅŸken mut dusmanlar2 = [100, 100, 100, 100];
    
    yazdir("ğŸ® SAVAÅ BAÅLIYOR!\n");
    yazdir("4 dÃ¼ÅŸman, her birinin 100 canÄ± var\n");
    
    normal_saldir(&mut dusmanlar1, 25);
    yazdir("");
    super_saldir(&mut dusmanlar2, 25);
    
    yazdir("\nâœ¨ SonuÃ§ aynÄ±, ama SÃœPER saldÄ±rÄ± 4x hÄ±zlÄ±!");
}
</code></pre>
                </div>
            </section>

            <section class="lesson-section">
                <h2>ğŸ“ <span class="tr">Ã–rnek 2: Piksel Boyama</span><span class="en" style="display:none;">Example 2: Pixel Painting</span></h2>
                <div class="code-block">
                    <div class="code-header"><span class="code-lang">ğŸ¨ pixels.berk</span><button onclick="copyCode(this)">ğŸ“‹ Kopyala</button></div>
                    <pre><code>// Ekranda 1000 piksel var
// Her pikseli tek tek boyamak yavaÅŸ!

fonksiyon ana() {
    deÄŸiÅŸken mut pikseller = [0; 1000];  // 1000 siyah piksel
    
    yazdir("ğŸ¨ 1000 piksel boyama yarÄ±ÅŸÄ±!\n");
    
    // Normal: Tek tek boya
    deÄŸiÅŸken baslangic1 = zaman_al();
    icin i in 0..1000 {
        pikseller[i] = 255;  // Beyaz yap
    }
    deÄŸiÅŸken sure1 = zaman_al() - baslangic1;
    yazdir("ğŸ‘† Normal boyama: {} ms", sure1);
    
    // SIMD: 8 piksel aynÄ± anda!
    deÄŸiÅŸken baslangic2 = zaman_al();
    pikseller.simd_doldur(255);  // Hepsini aynÄ± anda!
    deÄŸiÅŸken sure2 = zaman_al() - baslangic2;
    yazdir("âš¡ SIMD boyama: {} ms", sure2);
    
    yazdir("\nğŸ† SIMD {} kat daha hÄ±zlÄ±!", sure1 / sure2);
}
</code></pre>
                </div>

                <div class="exercise-box">
                    <h4>ğŸ¯ <span class="tr">SIMD Ne Zaman KullanÄ±lÄ±r?</span><span class="en" style="display:none;">When to Use SIMD?</span></h4>
                    <ul>
                        <li><span class="tr">ğŸ® Oyunlarda grafik iÅŸleme</span><span class="en" style="display:none;">ğŸ® Graphics processing in games</span></li>
                        <li><span class="tr">ğŸµ Ses ve mÃ¼zik iÅŸleme</span><span class="en" style="display:none;">ğŸµ Audio and music processing</span></li>
                        <li><span class="tr">ğŸ¤– Yapay zeka hesaplamalarÄ±</span><span class="en" style="display:none;">ğŸ¤– AI calculations</span></li>
                    </ul>
                </div>
            </section>
        </div>

        <!-- ==================== LÄ°SE ==================== -->
        <div class="lise-content" style="display:none;">
            <section class="lesson-section">
                <h2>ğŸ“– <span class="tr">SIMD Nedir?</span><span class="en" style="display:none;">What is SIMD?</span></h2>
                <p><span class="tr"><strong>S</strong>ingle <strong>I</strong>nstruction <strong>M</strong>ultiple <strong>D</strong>ata - Tek komut, Ã§ok veri. CPU'nun sÃ¼per gÃ¼cÃ¼!</span><span class="en" style="display:none;"><strong>S</strong>ingle <strong>I</strong>nstruction <strong>M</strong>ultiple <strong>D</strong>ata - One instruction, many data. CPU's superpower!</span></p>
                
                <div class="code-block">
                    <div class="code-header"><span class="code-lang">KarÅŸÄ±laÅŸtÄ±rma</span></div>
                    <pre><code>// Skaler (normal): 4 toplama = 4 iÅŸlem
a[0] = b[0] + c[0];  // Ä°ÅŸlem 1
a[1] = b[1] + c[1];  // Ä°ÅŸlem 2
a[2] = b[2] + c[2];  // Ä°ÅŸlem 3
a[3] = b[3] + c[3];  // Ä°ÅŸlem 4

// SIMD: 4 toplama = 1 iÅŸlem!
a[0..4] = b[0..4] + c[0..4];  // Tek iÅŸlem, 4 sonuÃ§!</code></pre>
                </div>
            </section>

            <section class="lesson-section">
                <h2>ğŸ“ <span class="tr">Ã–rnek 1: VektÃ¶r Toplama</span><span class="en" style="display:none;">Example 1: Vector Addition</span></h2>
                <div class="code-block">
                    <div class="code-header"><span class="code-lang">â• vector_add.berk</span><button onclick="copyCode(this)">ğŸ“‹ Kopyala</button></div>
                    <pre><code>kullan berk::simd::f32x4;

fonksiyon ana() {
    // 4 elemanlÄ± vektÃ¶rler
    deÄŸiÅŸken a = f32x4::yeni([1.0, 2.0, 3.0, 4.0]);
    deÄŸiÅŸken b = f32x4::yeni([5.0, 6.0, 7.0, 8.0]);
    
    // SIMD toplama - 4 toplama tek seferde!
    deÄŸiÅŸken sonuc = a + b;
    yazdir("a + b = {:?}", sonuc);  // [6.0, 8.0, 10.0, 12.0]
    
    // SIMD Ã§arpma
    deÄŸiÅŸken carpim = a * b;
    yazdir("a * b = {:?}", carpim);  // [5.0, 12.0, 21.0, 32.0]
    
    // Toplam (horizontal sum)
    deÄŸiÅŸken toplam = sonuc.toplam();
    yazdir("Toplam: {}", toplam);  // 36.0
}
</code></pre>
                </div>
            </section>

            <section class="lesson-section">
                <h2>ğŸ“ <span class="tr">Ã–rnek 2: GÃ¶rÃ¼ntÃ¼ ParlaklÄ±k</span><span class="en" style="display:none;">Example 2: Image Brightness</span></h2>
                <div class="code-block">
                    <div class="code-header"><span class="code-lang">ğŸ–¼ï¸ brightness.berk</span><button onclick="copyCode(this)">ğŸ“‹ Copy</button></div>
                    <pre><code>use berk::simd::u8x16;

function adjust_brightness(pixels: &mut [u8], factor: u8) {
    // 16 piksel aynÄ± anda iÅŸle
    for chunk in pixels.chunks_exact_mut(16) {
        let vec = u8x16::from_slice(chunk);
        let adjusted = vec.saturating_add(u8x16::splat(factor));
        adjusted.write_to_slice(chunk);
    }
}

function main() {
    // 1920x1080 gÃ¶rÃ¼ntÃ¼ = 2 milyon piksel
    let mut image = vec![128u8; 1920 * 1080];
    
    // Benchmark
    let start = Instant::now();
    adjust_brightness(&mut image, 30);
    let duration = start.elapsed();
    
    print("âœ… {} piksel iÅŸlendi", image.len());
    print("â±ï¸ SÃ¼re: {:?}", duration);
    print("ğŸ“Š HÄ±z: {:.2} MB/s", 
        image.len() as f64 / duration.as_secs_f64() / 1_000_000.0);
}
</code></pre>
                </div>
            </section>
        </div>

        <!-- ==================== ÃœNÄ°VERSÄ°TE ==================== -->
        <div class="universite-content" style="display:none;">
            <section class="lesson-section">
                <h2>ğŸ¯ <span class="tr">BerkVect: BERK'in SIMD KÃ¼tÃ¼phanesi</span><span class="en" style="display:none;">BerkVect: BERK's SIMD Library</span></h2>
                <ul>
                    <li><span class="tr">SSE, AVX2, AVX-512 desteÄŸi</span></li>
                    <li><span class="tr">Otomatik vektÃ¶rizasyon</span></li>
                    <li><span class="tr">Cache-aware algorithms</span></li>
                    <li><span class="tr">GPU fallback (CUDA/OpenCL)</span></li>
                </ul>
            </section>

            <section class="lesson-section">
                <h2>ğŸ“ <span class="tr">Ã–rnek 1: Matrix Multiplication</span><span class="en" style="display:none;">Example 1: Matrix Multiplication</span></h2>
                <div class="code-block">
                    <div class="code-header"><span class="code-lang">BERK (BerkVect)</span><button onclick="copyCode(this)">ğŸ“‹ Copy</button></div>
                    <pre><code>use berkvect::{Matrix, simd_matmul, CacheConfig};

function optimized_matmul(a: &Matrix<f32>, b: &Matrix<f32>) -> Matrix<f32> {
    // Cache-blocking parameters
    let config = CacheConfig {
        l1_block: 64,   // L1 cache block size
        l2_block: 256,  // L2 cache block size
        prefetch: true,
    };
    
    // Detect best SIMD level
    let simd_level = detect_simd();
    print!("Using: {:?}", simd_level);  // AVX2, AVX512, etc.
    
    // Blocked matrix multiplication with SIMD
    simd_matmul(a, b, &config)
}

// Manual SIMD implementation
#[target_feature(enable = "avx2")]
unsafe function matmul_avx2(
    a: &[f32], 
    b: &[f32], 
    c: &mut [f32],
    m: usize, n: usize, k: usize
) {
    use std::arch::x86_64::*;
    
    for i in 0..m {
        for j in (0..n).step_by(8) {
            let mut sum = _mm256_setzero_ps();
            
            for p in 0..k {
                let a_val = _mm256_broadcast_ss(&a[i * k + p]);
                let b_vec = _mm256_loadu_ps(&b[p * n + j]);
                sum = _mm256_fmadd_ps(a_val, b_vec, sum);
            }
            
            _mm256_storeu_ps(&mut c[i * n + j], sum);
        }
    }
}

function main() {
    let size = 1024;
    let a = Matrix::random(size, size);
    let b = Matrix::random(size, size);
    
    // Benchmark
    let start = Instant::now();
    let c = optimized_matmul(&a, &b);
    let elapsed = start.elapsed();
    
    // Calculate GFLOPS
    let flops = 2.0 * (size as f64).powi(3);
    let gflops = flops / elapsed.as_secs_f64() / 1e9;
    
    print!("Matrix: {}x{}", size, size);
    print!("Time: {:?}", elapsed);
    print!("Performance: {:.2} GFLOPS", gflops);
}
</code></pre>
                </div>
            </section>

            <section class="lesson-section">
                <h2>ğŸ“ <span class="tr">Ã–rnek 2: Neural Network Layer</span><span class="en" style="display:none;">Example 2: Neural Network Layer</span></h2>
                <div class="code-block">
                    <div class="code-header"><span class="code-lang">BERK (NN)</span><button onclick="copyCode(this)">ğŸ“‹ Copy</button></div>
                    <pre><code>use berkvect::{Tensor, ops};

struct DenseLayer {
    weights: Tensor<f32>,
    bias: Tensor<f32>,
}

impl DenseLayer {
    function forward(&self, input: &Tensor<f32>) -> Tensor<f32> {
        // SIMD-accelerated matrix multiplication
        let output = ops::matmul(input, &self.weights);
        
        // SIMD-accelerated bias addition
        let output = ops::add(&output, &self.bias);
        
        // SIMD-accelerated ReLU
        ops::relu(&output)
    }
}

// Fused operations for better performance
function fused_forward(
    input: &Tensor<f32>,
    weights: &Tensor<f32>,
    bias: &Tensor<f32>,
) -> Tensor<f32> {
    // Fused: Y = ReLU(X @ W + b)
    // Avoids intermediate allocations
    ops::fused_matmul_bias_relu(input, weights, bias)
}

function benchmark_layer() {
    let batch = 256;
    let input_size = 1024;
    let output_size = 512;
    
    let input = Tensor::random(&[batch, input_size]);
    let layer = DenseLayer {
        weights: Tensor::random(&[input_size, output_size]),
        bias: Tensor::zeros(&[output_size]),
    };
    
    // Warmup
    for _ in 0..10 {
        let _ = layer.forward(&input);
    }
    
    // Benchmark
    let iterations = 1000;
    let start = Instant::now();
    for _ in 0..iterations {
        let _ = layer.forward(&input);
    }
    let elapsed = start.elapsed();
    
    let avg_time = elapsed / iterations;
    let throughput = batch as f64 / avg_time.as_secs_f64();
    
    print!("Batch size: {}", batch);
    print!("Avg forward time: {:?}", avg_time);
    print!("Throughput: {:.0} samples/sec", throughput);
}

function main() {
    print!("ğŸ§  Neural Network SIMD Benchmark\n");
    benchmark_layer();
}
</code></pre>
                </div>
            </section>
        </div>

        <!-- ORTAK Ã–ZET -->
        <section class="lesson-section">
            <h2>ğŸ“Œ <span class="tr">Ã–zet</span><span class="en" style="display:none;">Summary</span></h2>
            <ul>
                <li><span class="tr">SIMD = Tek komut, Ã§oklu veri (4x-16x hÄ±zlanma)</span><span class="en" style="display:none;">SIMD = Single Instruction, Multiple Data (4x-16x speedup)</span></li>
                <li><span class="tr">VektÃ¶r iÅŸlemleri iÃ§in idealdir</span><span class="en" style="display:none;">Ideal for vector operations</span></li>
                <li><span class="tr">BerkVect kÃ¼tÃ¼phanesi ile kolay kullanÄ±m</span><span class="en" style="display:none;">Easy usage with BerkVect library</span></li>
            </ul>
        </section>

        <section class="lesson-section" style="text-align:center; padding: 2rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px;">
            <h2 style="color: white;">ğŸ‰ <span class="tr">TEBRÄ°KLER!</span><span class="en" style="display:none;">CONGRATULATIONS!</span></h2>
            <p style="color: white; font-size: 1.2rem;">
                <span class="tr">BERK 101 kursunu tamamladÄ±nÄ±z! ArtÄ±k BERK ile sistem programlamaya hazÄ±rsÄ±nÄ±z.</span>
                <span class="en" style="display:none;">You've completed BERK 101! You're now ready for systems programming with BERK.</span>
            </p>
            <a href="index.html" style="display: inline-block; margin-top: 1rem; padding: 0.75rem 1.5rem; background: white; color: #667eea; border-radius: 8px; text-decoration: none; font-weight: bold;">
                <span class="tr">ğŸ  Ana Sayfaya DÃ¶n</span>
                <span class="en" style="display:none;">ğŸ  Return to Home</span>
            </a>
        </section>
    </main>

    <footer class="lesson-footer">
        <a href="ders09.html">â† <span class="tr">Ã–nceki</span><span class="en" style="display:none;">Previous</span></a>
        <a href="index.html"><span class="tr">ğŸ  Ana Sayfa</span><span class="en" style="display:none;">ğŸ  Home</span></a>
    </footer>
    <script src="js/main.js"></script>
</body>
</html>



